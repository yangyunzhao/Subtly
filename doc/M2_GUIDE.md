# M2 开发指导 / M2 Step-by-Step Guide

> 目标：完成 **本地存储 MVP（无后端）**，实现最小闭环：
> 新增 → 列表 → 详情 → 编辑/删除。

## 0) 你需要准备的工具

- 微信开发者工具（已安装 ✅）
- VS Code（可选，但推荐）

---

## 1) 数据结构约定（本地存储）

在小程序本地存储中使用以下两个 key：

- `fitnessEntries`
- `bodyMetricsEntries`

建议数据结构：

```json
{
  "fitnessEntries": [
    {
      "id": "uuid",
      "date": "2024-01-01",
      "type": "running",
      "duration": 30,
      "count": 0,
      "calories": 300,
      "notes": ""
    }
  ],
  "bodyMetricsEntries": [
    {
      "id": "uuid",
      "date": "2024-01-01",
      "weight": 120,
      "waistline": 82
    }
  ]
}
```

> id 可以使用 `Date.now().toString()` 或简单的时间戳拼接生成即可。

---

## 2) Log 页面（新增记录）

### 功能要求
- 完成健身记录表单：
  - 日期（默认今天）
  - 类型（running / cycling / strength / plank / pushups / custom）
  - 时长（分钟）
  - 次数（可选）
  - 热量消耗（千卡）
  - 备注（可选）
- 完成身体数据表单：
  - 体重（斤）
  - 腰围（cm）
- 点击“保存健身记录”或“保存身体数据”后：
  - 分别写入对应本地存储
  - 成功提示
  - 跳转到 History 页面

### 页面效果
- 表单有基本布局（分组标题 + 输入框 + 选择器）
- 提交后不会报错

---

## 3) History 页面（历史列表）

### 功能要求
- 读取本地存储中的记录
- 按日期分组展示（最新日期在上）
- 提供筛选：
  - 近 7 天
  - 本月
- 点击某条记录进入 Detail 页面

### 页面效果
- 列表渲染正常
- 空数据时显示空状态

---

## 4) Detail 页面（查看 / 编辑 / 删除）

### 功能要求
- 展示记录详情（健身 + 身体数据）
- 提供“编辑”入口（允许修改并保存）
- 提供“删除”按钮（确认后删除）
- 删除后返回 History 页面

### 页面效果
- 能够正确更新或删除本地存储

---

## 5) Home 页面（入口 + 今日摘要）

### 功能要求
- 展示今日摘要：
  - 今日是否有健身记录
  - 今日是否有身体数据
- 提供入口按钮跳转到 Log / History

---

## 6) 完成标准（M2 Done）

✅ 以下都满足，即可认为 M2 完成：

1. **Log 页面**可以成功新增记录，并写入本地存储。
2. **History 页面**可以读取并展示记录，支持筛选。
3. **Detail 页面**可以查看、编辑、删除记录。
4. **Home 页面**能显示今日摘要，并可进入 Log / History。
5. 完成最小闭环：**新增 → 列表 → 详情 → 编辑/删除**。

---

## 下一步

完成后告诉我：**“M2 已完成”**，我们进入 M3（应用层 / 数据层分离）。
